create DATABASE Network;
use Network;

CREATE TABLE OutsideTCPConnections (
conn BIGINT UNSIGNED PRIMARY KEY,
host_a  VARCHAR(15) NOT NULL,
host_b  VARCHAR(15) NOT NULL,
port_a  INT  NOT NULL,
port_b  INT  NOT NULL,
first_packet REAL NOT NULL,
last_packet REAL NOT NULL,
total_packets_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
total_packets_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
resets_sent_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
resets_sent_b2a  BIGINT UNSIGNED ZEROFILL  NOT NULL,
ack_pkts_sent_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
ack_pkts_sent_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
pure_acks_sent_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
pure_acks_sent_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
sack_pkts_sent_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
sack_pkts_sent_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
dsack_pkts_sent_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
dsack_pkts_sent_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
max_sack_blks_ack_a2b BIGINT UNSIGNED ZEROFILL NOT NULL,
max_sack_blks_ack_b2a BIGINT UNSIGNED ZEROFILL NOT NULL,
unique_bytes_sent_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
unique_bytes_sent_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
actual_data_pkts_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
actual_data_pkts_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
actual_data_bytes_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
actual_data_bytes_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
rexmt_data_pkts_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
rexmt_data_pkts_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
rexmt_data_bytes_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
rexmt_data_bytes_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
zwnd_probe_pkts_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
zwnd_probe_pkts_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
zwnd_probe_bytes_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
zwnd_probe_bytes_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
outoforder_pkts_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
outoforder_pkts_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
pushed_data_pkts_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
pushed_data_pkts_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
SYN_pkts_sent_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
FIN_pkts_sent_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
SYN_pkts_sent_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
FIN_pkts_sent_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
req_1323_ws_a2b BOOL   NOT NULL, 
req_1323_ts_a2b BOOL   NOT NULL, 
req_1323_ws_b2a BOOL   NOT NULL,
req_1323_ts_b2a BOOL   NOT NULL,
adv_wind_scale_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
adv_wind_scale_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
req_sack_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
req_sack_b2a  BIGINT UNSIGNED ZEROFILL  NOT NULL,
sacks_sent_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
sacks_sent_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
urgent_data_pkts_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
urgent_data_pkts_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
urgent_data_bytes_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
urgent_data_bytes_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
mss_requested_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
mss_requested_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
max_segm_size_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
max_segm_size_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
min_segm_size_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
min_segm_size_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
avg_segm_size_a2b REAL UNSIGNED ZEROFILL  NOT NULL,
avg_segm_size_b2a REAL UNSIGNED ZEROFILL  NOT NULL,
max_win_adv_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
max_win_adv_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
min_win_adv_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
min_win_adv_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
zero_win_adv_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
zero_win_adv_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
avg_win_adv_a2b  REAL UNSIGNED ZEROFILL  NOT NULL,
avg_win_adv_b2a REAL UNSIGNED ZEROFILL  NOT NULL,
initial_window_bytes_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
initial_window_bytes_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
initial_window_pkts_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
initial_window_pkts_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
ttl_stream_length_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
ttl_stream_length_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
missed_data_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
missed_data_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
truncated_data_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
truncated_data_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
truncated_packets_a2b BIGINT UNSIGNED ZEROFILL  NOT NULL,
truncated_packets_b2a BIGINT UNSIGNED ZEROFILL  NOT NULL,
data_xmit_time_a2b REAL UNSIGNED ZEROFILL NOT NULL,
data_xmit_time_b2a REAL UNSIGNED ZEROFILL NOT NULL,
idletime_max_a2b REAL UNSIGNED ZEROFILL NOT NULL,
idletime_max_b2a REAL UNSIGNED ZEROFILL NOT NULL,
hardware_dups_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
hardware_dups_b2a  BIGINT UNSIGNED ZEROFILL  NOT NULL,
throughput_a2b  BIGINT UNSIGNED ZEROFILL  NOT NULL,
throughput_b2a  BIGINT UNSIGNED ZEROFILL  NOT NULL
);


# tcptrace -ln --tsv inside.tcpdump > inside.trace
# edit out the header information.
# or use 
#  IGNORE 10 LINES


# fields terminated by 
#load data infile "/home/duncan/NetworkData/inside.trace" into table TCPConnections;
#load data infile "/home/duncan/IntrusionDetection/1999/week1-monday.sql"  into table TCPConnections2 IGNORE 9 LINES;

# Warning messages?
